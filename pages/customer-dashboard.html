<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Customer Dashboard - Raj Marketing</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* Loading Page Styles */
    .loading-page {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      background: linear-gradient(135deg, #1a4b8c 0%, #0f3a6b 100%);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }
    
    .loading-page.hidden {
      opacity: 0;
      visibility: hidden;
    }
    
    .loader-container {
      text-align: center;
      color: white;
      animation: fadeInUp 0.8s ease;
    }
    
    .loader-logo {
      width: 100px;
      height: 100px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
      font-size: 3rem;
      color: white;
      animation: pulse 2s infinite;
    }
    
    .loader-title {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 10px;
    }
    
    .loader-subtitle {
      font-size: 1rem;
      opacity: 0.9;
      margin-bottom: 30px;
    }
    
    .loader-bar {
      width: 300px;
      height: 6px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      margin: 0 auto;
      overflow: hidden;
    }
    
    .loader-progress {
      width: 0%;
      height: 100%;
      background: #f0b202;
      border-radius: 10px;
      transition: width 0.3s ease;
    }
    
    .loader-steps {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
      font-size: 0.8rem;
    }
    
    .loader-step {
      opacity: 0.5;
      transition: opacity 0.3s;
    }
    
    .loader-step.active {
      opacity: 1;
      color: #f0b202;
    }
    
    /* Dashboard Styles */
    *{margin:0;padding:0;box-sizing:border-box}body{font-family:'Inter',sans-serif;background:#f8f9fa;opacity:0;animation:fadeIn 0.5s ease forwards}.header{background:#1a4b8c;color:white;padding:15px 0;position:sticky;top:0;z-index:100}.container{max-width:1200px;margin:0 auto;padding:0 20px}.header-content{display:flex;justify-content:space-between;align-items:center}.logo{display:flex;align-items:center;gap:10px;color:white;text-decoration:none;font-size:1.3rem;font-weight:700}.logout-btn{background:rgba(255,255,255,0.2);color:white;border:none;padding:8px 20px;border-radius:30px;cursor:pointer;display:flex;align-items:center;gap:8px;font-size:0.9rem}.logout-btn:hover{background:rgba(255,255,255,0.3)}.welcome-section{background:white;padding:30px 0;margin-bottom:30px;box-shadow:0 2px 10px rgba(0,0,0,0.05)}.profile{display:flex;align-items:center;gap:30px;flex-wrap:wrap}.profile-avatar{width:100px;height:100px;background:#1a4b8c;border-radius:50%;display:flex;align-items:center;justify-content:center;color:white;font-size:2.5rem}.profile-info h1{margin-bottom:10px;color:#1e2b3a}.profile-info p{margin-bottom:5px;color:#6c757d;display:flex;align-items:center;gap:8px}.badge{background:#f0b202;color:#1e2b3a;padding:4px 12px;border-radius:30px;font-size:0.8rem;font-weight:600;display:inline-block}.stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:30px}.stat-card{background:white;padding:25px;border-radius:10px;text-align:center;box-shadow:0 2px 10px rgba(0,0,0,0.05);transition:transform 0.2s}.stat-card:hover{transform:translateY(-5px)}.stat-number{font-size:2rem;font-weight:700;color:#1a4b8c;margin-bottom:5px}.stat-label{color:#6c757d;font-size:0.9rem}.dashboard-grid{display:grid;grid-template-columns:2fr 1fr;gap:20px}.card{background:white;border-radius:10px;padding:20px;margin-bottom:20px;box-shadow:0 2px 10px rgba(0,0,0,0.05)}.card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;padding-bottom:10px;border-bottom:2px solid #e9ecef}.card-header h3{display:flex;align-items:center;gap:8px;color:#1a4b8c}.order-item{display:flex;justify-content:space-between;align-items:center;padding:15px;border:1px solid #e9ecef;border-radius:8px;margin-bottom:10px;transition:all 0.2s}.order-item:hover{background:#f8f9fa;border-color:#1a4b8c}.order-info h4{margin-bottom:5px}.order-info p{font-size:0.85rem;color:#6c757d}.status{padding:4px 12px;border-radius:30px;font-size:0.8rem;font-weight:600}.status.pending{background:#fff3cd;color:#856404}.status.processing{background:#cce5ff;color:#004085}.status.completed{background:#d4edda;color:#155724}.status.dispatched{background:#d1ecf1;color:#0c5460}.empty-state{text-align:center;padding:40px;color:#6c757d}.empty-state i{font-size:3rem;margin-bottom:15px;color:#1a4b8c}.btn{display:inline-block;padding:10px 20px;background:#1a4b8c;color:white;text-decoration:none;border-radius:5px;border:none;cursor:pointer;font-size:0.9rem;transition:all 0.2s}.btn:hover{background:#0f3a6b}.btn-block{width:100%;text-align:center}.btn-warning{background:#f0b202;color:#1e2b3a}.btn-warning:hover{background:#d49b02}.btn-success{background:#28a745}.btn-success:hover{background:#218838}.quick-actions{display:grid;grid-template-columns:1fr;gap:10px;margin-top:15px}.toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%) translateY(100px);background:#1e2b3a;color:white;padding:12px 24px;border-radius:50px;box-shadow:0 5px 20px rgba(0,0,0,0.2);z-index:9999;transition:all 0.3s}.toast.show{transform:translateX(-50%) translateY(0)}@keyframes fadeInUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@keyframes fadeIn{to{opacity:1}}@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}@media(max-width:768px){.stats-grid{grid-template-columns:1fr 1fr}.dashboard-grid{grid-template-columns:1fr}.profile{flex-direction:column;text-align:center}}
  </style>
</head>
<body>
  <!-- Loading Page -->
  <div id="loading-page" class="loading-page">
    <div class="loader-container">
      <div class="loader-logo">
        <i class="fas fa-shield-alt"></i>
      </div>
      <h2 class="loader-title">Raj Marketing</h2>
      <p class="loader-subtitle">Loading your dashboard...</p>
      <div class="loader-bar">
        <div class="loader-progress" id="loaderProgress"></div>
      </div>
      <div class="loader-steps" id="loaderSteps">
        <span class="loader-step active" id="step1">Verifying</span>
        <span class="loader-step" id="step2">Loading Data</span>
        <span class="loader-step" id="step3">Preparing Dashboard</span>
      </div>
    </div>
  </div>

  <!-- Dashboard Content -->
  <header class="header">
    <div class="container">
      <div class="header-content">
        <a href="../index.html" class="logo">
          <i class="fas fa-shield-alt"></i>
          <span>Raj Marketing</span>
        </a>
        <button class="logout-btn" onclick="logout()">
          <i class="fas fa-sign-out-alt"></i> Logout
        </button>
      </div>
    </div>
  </header>

  <div class="welcome-section">
    <div class="container">
      <div class="profile">
        <div class="profile-avatar" id="profileAvatar">
          <i class="fas fa-user-circle"></i>
        </div>
        <div class="profile-info">
          <h1 id="customerName">Loading...</h1>
          <p><i class="fas fa-id-card"></i> ID: <span id="customerId">-</span></p>
          <p><i class="fas fa-phone"></i> <span id="customerPhone">-</span></p>
          <p><i class="fas fa-map-marker-alt"></i> <span id="customerAddress">-</span></p>
          <span class="badge" id="membershipBadge"><i class="fas fa-star"></i> Gold Member</span>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-number" id="totalOrders">0</div>
        <div class="stat-label">Total Orders</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="pendingOrders">0</div>
        <div class="stat-label">Pending</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="completedOrders">0</div>
        <div class="stat-label">Completed</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="activeJobs">0</div>
        <div class="stat-label">Active Jobs</div>
      </div>
    </div>

    <div class="dashboard-grid">
      <div>
        <div class="card">
          <div class="card-header">
            <h3><i class="fas fa-clock"></i> Recent Orders</h3>
            <a href="#" class="btn" style="padding:5px 15px;" onclick="showToast('View all orders')">View All</a>
          </div>
          <div id="recentOrders">
            <!-- Will be filled by JavaScript -->
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h3><i class="fas fa-chart-line"></i> Order Progress</h3>
          </div>
          <div id="activeOrder">
            <div class="empty-state">
              <i class="fas fa-box-open"></i>
              <p>No active orders</p>
            </div>
          </div>
        </div>
      </div>
      
      <div>
        <div class="card">
          <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
          <div class="quick-actions">
            <a href="products.html" class="btn btn-block">
              <i class="fas fa-shopping-cart"></i> Order New Net
            </a>
            <a href="contact.html" class="btn btn-block btn-warning">
              <i class="fas fa-tools"></i> Request Service
            </a>
            <a href="tel:+919480337385" class="btn btn-block btn-success">
              <i class="fas fa-phone-alt"></i> Call Support
            </a>
            <a href="estimate.html" class="btn btn-block">
              <i class="fas fa-calculator"></i> Get Estimate
            </a>
          </div>
        </div>

        <div class="card">
          <h3><i class="fas fa-bell"></i> Notifications</h3>
          <div id="notifications">
            <div class="order-item">
              <div>
                <h4>Welcome to Raj Marketing!</h4>
                <p>Thank you for being a valued customer</p>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <h3><i class="fas fa-shield-alt"></i> Membership Benefits</h3>
          <ul style="list-style:none; padding:0;">
            <li style="margin-bottom:10px;"><i class="fas fa-check-circle" style="color:#28a745;"></i> 15% off on all services</li>
            <li style="margin-bottom:10px;"><i class="fas fa-check-circle" style="color:#28a745;"></i> Free annual maintenance</li>
            <li style="margin-bottom:10px;"><i class="fas fa-check-circle" style="color:#28a745;"></i> Priority installation</li>
            <li style="margin-bottom:10px;"><i class="fas fa-check-circle" style="color:#28a745;"></i> Extended warranty</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    // Loading animation control
    const loader = document.getElementById('loading-page');
    const progress = document.getElementById('loaderProgress');
    const steps = {
      step1: document.getElementById('step1'),
      step2: document.getElementById('step2'),
      step3: document.getElementById('step3')
    };

    // Step 1: Verify user
    function updateLoadingStep(step, percent) {
      progress.style.width = percent + '%';
      
      // Update active step
      Object.keys(steps).forEach(key => steps[key].classList.remove('active'));
      
      if (step === 1) steps.step1.classList.add('active');
      else if (step === 2) steps.step2.classList.add('active');
      else if (step === 3) steps.step3.classList.add('active');
    }

    // Check login
    updateLoadingStep(1, 30);
    
    const currentUser = JSON.parse(localStorage.getItem('currentUser') || sessionStorage.getItem('currentUser'));
    
    if (!currentUser || currentUser.type !== 'customer') {
      window.location.href = 'customer-login.html';
    }

    // Step 2: Load data
    setTimeout(() => {
      updateLoadingStep(2, 60);
      
      // Load user data
      document.getElementById('customerName').textContent = currentUser.name || 'Customer';
      document.getElementById('customerId').textContent = currentUser.id || 'CUST' + Date.now();
      document.getElementById('customerPhone').textContent = currentUser.phone || 'Not provided';
      document.getElementById('customerAddress').textContent = currentUser.address || 'Mysore';
      
      if (currentUser.membership) {
        document.getElementById('membershipBadge').innerHTML = `<i class="fas fa-star"></i> ${currentUser.membership} Member`;
      }

      // Load orders from storage
      const orders = JSON.parse(localStorage.getItem(`orders_${currentUser.id}`) || '[]');
      
      // Update stats
      const totalOrders = orders.length;
      const pendingOrders = orders.filter(o => o.status === 'pending' || o.status === 'processing').length;
      const completedOrders = orders.filter(o => o.status === 'completed' || o.status === 'installed').length;
      const activeJobs = orders.filter(o => o.status === 'processing' || o.status === 'dispatched').length;
      
      document.getElementById('totalOrders').textContent = totalOrders;
      document.getElementById('pendingOrders').textContent = pendingOrders;
      document.getElementById('completedOrders').textContent = completedOrders;
      document.getElementById('activeJobs').textContent = activeJobs;

      // Display recent orders
      const recentDiv = document.getElementById('recentOrders');
      
      if (orders.length > 0) {
        recentDiv.innerHTML = orders.slice(0, 3).map(order => `
          <div class="order-item">
            <div class="order-info">
              <h4>Order #${order.id}</h4>
              <p><i class="fas fa-calendar"></i> ${order.date || new Date().toLocaleDateString()}</p>
              <p><i class="fas fa-box"></i> ${order.items || 'Nets'} - â‚¹${order.amount || 0}</p>
            </div>
            <span class="status ${order.status}">${order.status || 'pending'}</span>
          </div>
        `).join('');
      } else {
        recentDiv.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-box-open"></i>
            <p>No orders yet</p>
            <a href="products.html" class="btn" style="margin-top:15px;">Browse Products</a>
          </div>
        `;
      }

      // Check for active order
      const activeOrder = orders.find(o => o.status === 'processing' || o.status === 'dispatched');
      const activeDiv = document.getElementById('activeOrder');
      
      if (activeOrder) {
        activeDiv.innerHTML = `
          <div class="order-item">
            <div>
              <h4>Order #${activeOrder.id}</h4>
              <p>Status: ${activeOrder.status}</p>
              <div style="margin-top:10px;">
                <div style="height:5px; background:#e9ecef; border-radius:5px; overflow:hidden;">
                  <div style="width:${activeOrder.progress || 60}%; height:100%; background:#1a4b8c;"></div>
                </div>
              </div>
            </div>
          </div>
        `;
      }

      // Step 3: Hide loader
      setTimeout(() => {
        updateLoadingStep(3, 100);
        setTimeout(() => {
          loader.classList.add('hidden');
        }, 300);
      }, 300);
      
    }, 400);

    // Toast notification
    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 2000);
    }

    // Logout function
    function logout() {
      if (confirm('Are you sure you want to logout?')) {
        // Show loading
        loader.classList.remove('hidden');
        updateLoadingStep(1, 50);
        
        setTimeout(() => {
          localStorage.removeItem('currentUser');
          sessionStorage.removeItem('currentUser');
          window.location.href = 'customer-login.html';
        }, 500);
      }
    }

    // Make showToast global
    window.showToast = showToast;
  </script>
</body>
            </html>
